---
version: '0.0.3-alpha-1'

environment:
  defaultServices:
    - name: 'lc-test'
    - name: 'lc-test-k8s'

services:
  - name: 'lc-test'
    defaultUUID: 'good-dev-0'
    github:
      repository: 'vmelikyan/lc-test'
      branchName: 'main'
      docker:
        defaultTag: 'main'
        app:
          dockerfilePath: 'sysops/dockerfiles/app.dockerfile'
          env:
            YOLO: '{{yolo-db_internalHostname}}'
            TEST_HOST: '{{test-host_internalHostname}}'
            POS_DB: '{{pos-discounts-db_internalHostname}}'
          ports:
            - 8080
        init:
          dockerfilePath: 'sysops/dockerfiles/init.dockerfile'
      deployment:
        public: true
        capacityType: 'SPOT'
        resource:
          cpu:
            request: '10m'
          memory:
            request: '100Mi'
        readiness:
          tcpSocketPort: 8080
          httpGet:
            port: 8080
        network:
          ingressAnnotations:
            nginx.ingress.kubernetes.io/server-snippet: 'large_client_header_buffers 4 8k'
  - name: 'lc-test-k8s'
    defaultUUID: 'good-dev-0'
    github:
      repository: 'vmelikyan/lc-test'
      branchName: 'main'
      docker:
        defaultTag: 'main'
        app:
          dockerfilePath: 'sysops/dockerfiles/app.dockerfile'
          env:
            YOLO: '{{lc-test-helm_internalHostname}}'
            TEST_HOST: '{{test-host_internalHostname}}'
            POS_DB: '{{pos-discounts-db_internalHostname}}'
          ports:
            - 8080
        init:
          dockerfilePath: 'sysops/dockerfiles/init.dockerfile'
      deployment:
        public: true
        capacityType: 'SPOT'
        resource:
          cpu:
            request: '10m'
          memory:
            request: '100Mi'
        readiness:
          tcpSocketPort: 8080
          httpGet:
            port: 8080
        network:
          ingressAnnotations:
            nginx.ingress.kubernetes.io/server-snippet: 'large_client_header_buffers 4 8k'
